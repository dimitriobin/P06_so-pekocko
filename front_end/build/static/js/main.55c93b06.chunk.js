(this.webpackJsonpfront_end=this.webpackJsonpfront_end||[]).push([[0],{171:function(e,t,a){"use strict";a.r(t);var s=a(2),n=a(55),r=a.n(n),c=a(12),l=(a(63),a(3)),i=a.p+"static/media/logo.79ea3534.svg",o=a(4),u=(a(64),a(58)),d=a(56),m=a.n(d).a.create({baseURL:"https://p06-so-peckoko-api.herokuapp.com/api",headers:{"Content-type":"application/json"}});function f(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer ".concat(e.token)}:{}}var b={register:function(e){return m.post("auth/signup",e)},login:function(e){return m.post("auth/login",e).then((function(e){e.data.token&&localStorage.setItem("user",JSON.stringify(e.data))}))},logout:function(){localStorage.removeItem("user")},getCurrentUser:function(){return JSON.parse(localStorage.getItem("user"))}},j={getAll:function(){return m.get("/sauces",{headers:f()}).then((function(e){return Promise.resolve(e)})).catch((function(e){if(401!==e.response.status||"Please login"!==e.response.data)return Promise.reject(e);b.logout()}))},createOne:function(e){return m.post("/sauces",e,{headers:f()}).then((function(e){return Promise.resolve(e)})).catch((function(e){if(401!==e.response.status||"Please login"!==e.response.data)return Promise.reject(e);b.logout()}))},getOne:function(e){return m.get("/sauces/".concat(e),{headers:f()}).then((function(e){return Promise.resolve(e)})).catch((function(e){if(401!==e.response.status||"Please login"!==e.response.data)return Promise.reject(e);b.logout()}))},updateOne:function(e,t){return m.put("/sauces/".concat(e),t,{headers:f()}).then((function(e){return Promise.resolve(e)})).catch((function(e){if(401!==e.response.status||"Please login"!==e.response.data)return Promise.reject(e);b.logout()}))},deleteOne:function(e){return m.delete("/sauces/".concat(e),{headers:f()}).then((function(e){return Promise.resolve(e)})).catch((function(e){if(401!==e.response.status||"Please login"!==e.response.data)return Promise.reject(e);b.logout()}))},likeOne:function(e,t){return m.post("/sauces/".concat(e,"/like"),t,{headers:f()}).then((function(e){return Promise.resolve(e)})).catch((function(e){if(401!==e.response.status||"Please login"!==e.response.data)return Promise.reject(e);b.logout()}))}},h=a.p+"static/media/hot_rank_1.a0a4b71c.svg",g=a.p+"static/media/hot_rank_2.8ac5e470.svg",x=a.p+"static/media/hot_rank_3.b0204346.svg",p=a.p+"static/media/hot_rank_4.d61e9baf.svg",O=a.p+"static/media/hot_rank_5.2e74a307.svg",v=a(0),w={hot1:h,hot2:g,hot3:x,hot4:p,hot5:O};var N=function(e){var t=e.sauce;return Object(v.jsx)(c.b,{to:"/sauce/".concat(t._id),children:Object(v.jsxs)("article",{className:"sauce-card relative overflow-hidden border rounded-3xl h-96 shadow-lg cursor-pointer",children:[Object(v.jsx)("img",{src:t.imageUrl,alt:t.description,className:"w-full h-auto"}),Object(v.jsxs)("div",{className:"p-5 absolute bottom-0 bg-white h-2/5 w-full flex flex-col justify-center items-center text-center",children:[Object(v.jsx)("img",{src:w["hot".concat(t.heat)],alt:"Cette sauce a obtenu la note de ".concat(t.heat," sur 5"),className:"inline h-20 w-20 p-2 rounded-full bg-white border shadow-lg absolute"}),Object(v.jsx)("h2",{className:"text-lg font-semibold uppercase truncate w-full",title:"full text",children:t.name}),Object(v.jsxs)("p",{className:"italic",children:["by ",t.manufacturer]})]})]})})},y=a(23),k=a(13),S=a(16),P=a.n(S),C=a(9),F=a.n(C),D=a(17),U=a.n(D),_=a(24),I=function(e){if(!e)return Object(v.jsx)("div",{className:"font-medium text-red-500",role:"alert",children:"This field is required!"})},L=function(e){if(!Object(_.isLength)(e,{min:5,max:200}))return Object(v.jsx)("div",{className:"font-medium text-red-500",role:"alert",children:"This must be between 5 and 200 characters"})};var R=function(e){var t=b.getCurrentUser().userId,a=e.value,n={userId:t,name:a?a.name:"",manufacturer:a?a.manufacturer:"",description:a?a.description:"",mainPepper:a?a.mainPepper:"",imageUrl:a?a.imageUrl:null,heat:a?a.heat:0},r=Object(s.useState)(n),c=Object(l.a)(r,2),i=c[0],o=c[1],u=Object(s.useState)(e.value?e.value.imageUrl:null),d=Object(l.a)(u,2),m=d[0],f=d[1],j=Object(s.useRef)(),h=Object(s.useRef)(),g=Object(s.useRef)(),x=function(e){"imageUrl"===e.target.name?(o(Object(k.a)(Object(k.a)({},i),{},{imageUrl:e.target.files[0]})),f(URL.createObjectURL(e.target.files[0]))):o(Object(k.a)(Object(k.a)({},i),{},Object(y.a)({},e.target.name,e.target.value)))};return Object(v.jsx)("div",{className:"popup__bg bg-black bg-opacity-80 absolute top-0 right-0 left-0 bottom-0 z-10",children:Object(v.jsxs)(P.a,{onSubmit:function(t){if(t.preventDefault(),j.current.validateAll(),0===h.current.context._errors.length){var a=new FormData;Object.entries(i).forEach((function(e){var t=Object(l.a)(e,2),s=t[0],n=t[1];null!==n&&""!==n&&a.append("".concat(s),n)})),e.onDataSubmit(a),e.showSauceForm(!1)}},ref:j,className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-5 md:p-8 lg:p-10 w-11/12 md:w-8/12 lg:w-6/12 xl:w-5/12 2xl:w-4/12 rounded-3xl flex flex-col",children:[Object(v.jsx)("label",{htmlFor:"name",className:"font-medium mb-1",children:"Sauce's name"}),Object(v.jsx)(F.a,{type:"text",name:"name",id:"name",value:i.name,onChange:x,validations:[I,L],className:"w-full border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all"}),Object(v.jsx)("label",{htmlFor:"manufacturer",className:"font-medium mb-1",children:"Sauce's manufacturer"}),Object(v.jsx)(F.a,{type:"text",name:"manufacturer",id:"manufacturer",value:i.manufacturer,onChange:x,validations:[I,L],className:"w-full border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all"}),Object(v.jsx)("label",{htmlFor:"description",className:"font-medium mb-1",children:"Description"}),Object(v.jsx)(F.a,{type:"text",name:"description",id:"description",value:i.description,onChange:x,validations:[I,L],className:"w-full border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all"}),Object(v.jsx)("label",{htmlFor:"mainPepper",className:"font-medium mb-1",children:"Main ingredient"}),Object(v.jsx)(F.a,{type:"text",name:"mainPepper",id:"mainPepper",value:i.mainPepper,onChange:x,validations:[I,L],className:"w-full border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all"}),i.imageUrl?Object(v.jsx)("label",{htmlFor:"image",className:"w-28 h-28 rounded-full font-medium cursor-pointer mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white focus:outline-none transition-all",tabIndex:"0",children:Object(v.jsx)("img",{src:m,alt:"Preview of you sauce",className:"flex w-28 h-28 rounded-full mb-1 cursor-pointer flex-col justify-center items-center border-2 border-black hover:opacity-90 focus:outline-none transition-all"})}):Object(v.jsx)("label",{htmlFor:"image",className:"w-28 h-28 rounded-full font-medium cursor-pointer mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white focus:outline-none transition-all",tabIndex:"0",children:Object(v.jsx)("span",{className:"flex text-center w-28 h-28 rounded-full mb-1 cursor-pointer flex-col justify-center items-center border-2 border-black hover:opacity-90 focus:outline-none transition-all",children:"Add an image"})}),Object(v.jsx)(F.a,{type:"file",name:"imageUrl",id:"image",className:"hidden",ref:g,onChange:x}),Object(v.jsx)("label",{htmlFor:"rank",className:"font-medium mb-1",children:"Hot rank"}),Object(v.jsx)(F.a,{type:"range",name:"heat",id:"rank",min:"1",max:"5",value:i.heat,onChange:x,validations:[I],className:"w-full border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all"}),Object(v.jsxs)("div",{className:"flex justify-evenly",children:[Object(v.jsx)("button",{type:"submit",className:"bg-green-500 hover:bg-green-900 focus:bg-green-900 active:bg-green-900 rounded-full p-3 w-5/12 uppercase font-bold text-white text-xl focus:outline-none transition-all",children:"Add"}),Object(v.jsx)("button",{onClick:function(t){t.preventDefault(),e.showSauceForm(!1)},className:"bg-red-500 hover:bg-red-900 focus:bg-red-900 active:bg-red-900 rounded-full p-3 w-5/12 uppercase font-bold text-white text-xl focus:outline-none transition-all",children:"Back"})]}),Object(v.jsx)(U.a,{style:{display:"none"},ref:h})]})})};var A=function(){var e=Object(s.useState)(!1),t=Object(l.a)(e,2),a=t[0],n=t[1],r=Object(s.useState)([]),c=Object(l.a)(r,2),i=c[0],o=c[1];Object(s.useEffect)((function(){d()}),[]);var d=function(){j.getAll().then((function(e){o(e.data.reverse())})).catch((function(e){console.log(e)}))};return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("button",{onClick:function(e){e.preventDefault(),n(!0)},className:"underline mb-8 mx-auto block text-xl",children:"Add a new sauce"}),a&&Object(v.jsx)(R,{showSauceForm:n,onDataSubmit:function(e){j.createOne(e).then((function(e){o([e.data].concat(Object(u.a)(i)))})).catch((function(e){console.log(e)}))}}),Object(v.jsx)("div",{className:"grid grid-cols-auto-fill xl:grid-cols-4 gap-10 content-center justify-center",children:i&&i.map((function(e,t){return Object(v.jsx)(N,{sauce:e},t)}))})]})},E={hot1:h,hot2:g,hot3:x,hot4:p,hot5:O};var T=function(e){var t=b.getCurrentUser().userId,a={description:"",heat:"",imageUrl:null,mainPepper:"",manufacturer:"",name:"",userId:t,usersLiked:[],usersDisliked:[],likes:0,dislikes:0},n=Object(s.useState)(a),r=Object(l.a)(n,2),i=r[0],u=r[1],d=Object(s.useState)(!1),m=Object(l.a)(d,2),f=m[0],h=m[1],g=Object(s.useState)(!1),x=Object(l.a)(g,2),p=x[0],O=x[1];Object(s.useEffect)((function(){var t;t=e.match.params.id,j.getOne(t).then((function(e){u(e.data)})).catch((function(e){return console.log(e)}))}),[e.match.params.id]);var w=function(){h(!f)};return Object(v.jsxs)("main",{className:"flex flex-col lg:flex-row justify-start lg:justify-center items-center px-10",children:[p&&Object(v.jsx)(o.a,{to:"/"}),Object(v.jsx)(c.b,{to:"/",children:Object(v.jsx)("i",{className:"fas fa-arrow-left fa-3x absolute top-5 md:top-10 lg:top-20 left-5 md:left-10 lg:left-20"})}),f&&Object(v.jsx)(R,{value:i,showSauceForm:w,onDataSubmit:function(t){j.updateOne(e.match.params.id,t).then((function(e){u(e.data)})).catch((function(e){return console.log(e)}))}}),Object(v.jsxs)("div",{className:"relative",children:[Object(v.jsx)("img",{src:i.imageUrl,alt:i.description,className:"w-full max-w-lg rounded-3xl h-auto"}),Object(v.jsx)("img",{src:E["hot".concat(i.heat)],alt:"Cette sauce a obtenu la note de ".concat(i.heat," sur 5"),className:"h-20 w-20 p-2 rounded-full bg-white border shadow-lg absolute bottom-0 right-0 transform translate-x-1/3 translate-y-1/3"})]}),Object(v.jsxs)("div",{className:"w-full lg:w-1/2 text-center lg:text-left lg:ml-10",children:[Object(v.jsx)("h1",{className:"text-6xl font-bold mt-5 mb-2",children:i.name}),Object(v.jsxs)("h2",{className:" text-3xl font-medium mb-2",children:["Made with ",i.mainPepper]}),Object(v.jsxs)("p",{className:"italic text-xl mb-3",children:["by ",i.manufacturer]}),Object(v.jsx)("p",{children:i.description}),i.userId===t&&Object(v.jsxs)("div",{className:"my-4",children:[Object(v.jsx)("button",{onClick:w,className:"bg-yellow-500 p-3 font-medium rounded-full shadow-lg my-2 mr-2 text-white",children:"update"}),Object(v.jsx)("button",{onClick:function(){j.deleteOne(e.match.params.id).then((function(){O(!0)})).catch((function(e){console.log(e)}))},className:"bg-red-500 p-3 font-medium rounded-full shadow-lg my-2 text-white",children:"delete"})]}),Object(v.jsxs)("div",{className:"flex justify-evenly lg:justify-start items-center",children:[Object(v.jsxs)("button",{onClick:function(){var a=i.likes>0?0:1;j.likeOne(e.match.params.id,{userId:t,like:a}).then((function(e){u(Object(k.a)(Object(k.a)({},i),{},{likes:a>0?1:0,usersLiked:a>0?[t]:[]}))})).catch((function(e){return console.log(e)}))},name:"like","aria-label":"Like the sauce",className:i.dislikes>0?"cursor-not-allowed tooltip":"tooltip",disabled:i.dislikes>0,children:[i.usersLiked.length>0&&Object(v.jsxs)("span",{className:"tooltiptext",children:[i.usersLiked.length," persons like this sauce"]}),i.likes>0?Object(v.jsx)("i",{className:"fas fa-thumbs-up fa-4x lg:mx-5"}):Object(v.jsx)("i",{className:"far fa-thumbs-up fa-4x lg:mx-5"})]}),Object(v.jsxs)("button",{onClick:function(){var a=i.dislikes>0?0:-1;j.likeOne(e.match.params.id,{userId:t,like:a}).then((function(e){u(Object(k.a)(Object(k.a)({},i),{},{dislikes:a<0?1:0,usersDisliked:a<0?[t]:[]})),console.log(i.dislikes)})).catch((function(e){return console.log(e)}))},name:"dislike","aria-label":"Dislike the sauce",className:i.likes>0?"cursor-not-allowed tooltip":"tooltip",disabled:i.likes>0,children:[i.usersDisliked.length>0&&Object(v.jsxs)("span",{className:"tooltiptext",children:[i.usersDisliked.length," persons doesn't like this sauce"]}),i.dislikes>0?Object(v.jsx)("i",{className:"fas fa-thumbs-down fa-4x lg:mx-5 relative"}):Object(v.jsx)("i",{className:"far fa-thumbs-down fa-4x lg:mx-5"})]})]})]})]})},J=function(e){if(!e)return Object(v.jsx)("div",{className:"font-medium text-red-500",role:"alert",children:"This field is required!"})},B=function(e){var t=Object(s.useRef)(),a=Object(s.useRef)(),n=Object(s.useState)(""),r=Object(l.a)(n,2),c=r[0],i=r[1],o=Object(s.useState)(""),u=Object(l.a)(o,2),d=u[0],m=u[1],f=Object(s.useState)(!1),j=Object(l.a)(f,2),h=j[0],g=j[1],x=Object(s.useState)(""),p=Object(l.a)(x,2),O=p[0],w=p[1];return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(P.a,{onSubmit:function(s){s.preventDefault(),w(""),g(!0),t.current.validateAll(),0===a.current.context._errors.length?b.login({email:c,password:d}).then((function(){e.history.push("/sauces"),window.location.reload()}),(function(e){var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();g(!1),w(t)})):g(!1)},ref:t,className:"flex flex-col content-center justify-center items-center",children:[Object(v.jsxs)("div",{className:"mb-2",children:[Object(v.jsx)("label",{htmlFor:"email",className:"font-medium mb-1",children:"Email"}),Object(v.jsx)(F.a,{type:"text",className:"border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all",name:"email",value:c,onChange:function(e){var t=e.target.value;i(t)},validations:[J]})]}),Object(v.jsxs)("div",{className:"mb-2",children:[Object(v.jsx)("label",{htmlFor:"password",className:"font-medium mb-1",children:"Password"}),Object(v.jsx)(F.a,{type:"password",className:"border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all",name:"password",value:d,onChange:function(e){var t=e.target.value;m(t)},validations:[J]})]}),Object(v.jsxs)("button",{className:"bg-green-500 hover:bg-green-900 focus:bg-green-900 active:bg-green-900 rounded-full p-3 w-5/12 uppercase font-bold text-white text-xl focus:outline-none transition-all",children:[h&&Object(v.jsx)("i",{className:"fas fa-spinner animate-spin"}),"Log in"]}),O&&Object(v.jsx)("div",{className:"",children:Object(v.jsx)("p",{className:"text-red-500",role:"alert",children:O})}),Object(v.jsx)(U.a,{style:{display:"none"},ref:a})]})})},q=function(e){if(!e)return Object(v.jsx)("div",{className:"",role:"alert",children:"This field is required!"})},z=function(e){if(!Object(_.isEmail)(e))return Object(v.jsx)("div",{className:"",role:"alert",children:"This is not a valid email."})},M=function(e){if(e.length<6||e.length>40)return Object(v.jsx)("div",{className:"",role:"alert",children:"The password must be between 6 and 40 characters."})};var H=function(e){var t=Object(s.useRef)(),a=Object(s.useRef)(),n=Object(s.useState)(""),r=Object(l.a)(n,2),c=r[0],i=r[1],o=Object(s.useState)(""),u=Object(l.a)(o,2),d=u[0],m=u[1],f=Object(s.useState)(!1),j=Object(l.a)(f,2),h=j[0],g=j[1],x=Object(s.useState)(""),p=Object(l.a)(x,2),O=p[0],w=p[1];return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)(P.a,{onSubmit:function(e){e.preventDefault(),w(""),g(!1),t.current.validateAll(),0===a.current.context._errors.length&&b.register({email:c,password:d}).then((function(e){w(e.data.message),g(!0)})).catch((function(e){var t=e.response&&e.response.Data&&e.response.data.message||e.message||e.toString();w(t),g(!1)}))},ref:t,className:"flex flex-col content-center justify-center items-center",children:[!h&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("div",{className:"mb-2",children:[Object(v.jsx)("label",{htmlFor:"email",className:"font-medium mb-1",children:"Email"}),Object(v.jsx)(F.a,{type:"text",className:"border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all",name:"email",value:c,onChange:function(e){var t=e.target.value;i(t)},validations:[q,z]})]}),Object(v.jsxs)("div",{className:"mb-2",children:[Object(v.jsx)("label",{htmlFor:"password",className:"font-medium mb-1",children:"Password"}),Object(v.jsx)(F.a,{type:"password",className:"border-2 border-black rounded px-3 py-2 text-xl mb-4 focus:ring focus:ring-yellow-600 focus:ring-offset-4 focus:ring-offset-white  transition-all",name:"password",value:d,onChange:function(e){var t=e.target.value;m(t)},validations:[q,M]})]}),Object(v.jsx)("button",{className:"bg-green-500 hover:bg-green-900 focus:bg-green-900 active:bg-green-900 rounded-full p-3 w-5/12 uppercase font-bold text-white text-xl focus:outline-none transition-all",children:"Sign Up"})]}),O&&Object(v.jsx)("div",{className:"",children:Object(v.jsx)("p",{className:h?"text-green-500":"text-red-500",role:"alert",children:O})}),Object(v.jsx)(U.a,{style:{display:"none"},ref:a})]})})};var G=function(){var e=Object(s.useState)(),t=Object(l.a)(e,2),a=t[0],n=t[1];return Object(s.useEffect)((function(){var e=b.getCurrentUser();e&&n(e)}),[]),Object(v.jsxs)("div",{className:"App min-h-screen flex flex-col justify-between items-center relative",children:[Object(v.jsxs)("nav",{className:"container relative flex items-center justify-center mb-10 lg:mb-20",children:[Object(v.jsx)(c.b,{to:"/",children:Object(v.jsx)("img",{src:i,alt:"logo de l'application",className:"inline my-10"})}),a?Object(v.jsx)("button",{onClick:function(e){e.preventDefault(),b.logout(),n(void 0)},className:"absolute top-5 md:top-10 lg:top-20 right-5 md:right-10 lg:right-20",children:Object(v.jsx)("i",{className:"fas fa-sign-out-alt fa-3x"})}):Object(v.jsxs)("div",{className:"absolute top-5 md:top-10 lg:top-20 right-5 md:right-10 lg:right-20",children:[Object(v.jsx)(c.b,{to:"/signup",className:"mr-5",children:"Signup"}),Object(v.jsx)(c.b,{to:"/login",children:"Login"})]})]}),a?Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("div",{className:"container mx-auto",children:Object(v.jsxs)(o.d,{children:[Object(v.jsx)(o.b,{exact:!0,path:["/","/sauces"],component:A}),Object(v.jsx)(o.b,{path:"/sauce/:id",component:T})]})})}):Object(v.jsx)("div",{className:"container mx-auto",children:Object(v.jsxs)(o.d,{children:[Object(v.jsx)(o.b,{exact:!0,path:["/","/login"],component:B}),Object(v.jsx)(o.b,{path:"/signup",component:H})]})}),Object(v.jsxs)("footer",{className:"bg-gray-900 text-white w-full p-10 flex flex-wrap justify-evenly items-center mt-20",children:[Object(v.jsx)("p",{className:"my-1",children:"Copyright 2021"}),Object(v.jsx)("a",{className:"underline my-1",href:"https://dimitriobin.com",children:"dimitriobin.com"}),Object(v.jsx)("a",{className:"underline my-1",href:"mailto:dimitriobin@gmail.com",children:"Reach me out here"})]})]})},K=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,172)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),s(e),n(e),r(e),c(e)}))};r.a.render(Object(v.jsx)(c.a,{children:Object(v.jsx)(G,{})}),document.getElementById("root")),K()},63:function(e,t,a){},64:function(e,t,a){}},[[171,1,2]]]);
//# sourceMappingURL=main.55c93b06.chunk.js.map